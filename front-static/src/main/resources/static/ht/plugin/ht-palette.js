!function(q,w,G){"use strict";var b="px",A="0",Z="innerHTML",$="className",v=ht.Default,n=ht.Color,g=ht.Node,T="position",W="top",Y="left",u=v.animate,k=v.getInternal(),C="width",A="0",O="none",I="max-height",M="font",B="background",P="border-box",z="user-select",r="box-sizing",F="overflow",f=v.isTouchable,k=v.getInternal(),H=n.titleIconBackground,e=v.scrollBarInteractiveSize,Q=/msie 9/.test(q.navigator?q.navigator.userAgent.toLowerCase():""),i=null,J=function(){return document},x=function(s){return J().createElement(s)},s=function(){return x("div")},c=function(){var b=s(),L=b.style;return L.msTouchAction=O,L.cursor="default",f&&L.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",i),L.position="absolute",L.left=A,L.top=A,b},j=function(){return x("canvas")},V=function(){return document.body},y=function(L,j,V){L.style.setProperty(j,V,i)},t=function(W,Y){W.style.removeProperty(Y)},l=function(G,Y,D){v.def(ht.widget[G],Y,D)},h=function(E,K){E.appendChild(K)},L=function(p,T){p.removeChild(T)},E=function(r,v,d,R){r.addEventListener(v,d,!!R)};k.addMethod(v,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:H,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:H}]},paletteTitleLabelColor:v.labelSelectColor,paletteTitleLabelFont:v.labelFont,paletteContentLabelFont:v.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:v.widgetTitleHeight,paletteTitleBackground:n.titleBackground,paletteTitleHoverBackground:n.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:G,paletteItemHoverBorderColor:n.highlight,paletteItemSelectBackground:n.highlight},!0);var d=".palette-item:hover{border: 1px solid "+v.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+v.paletteTitleHoverBackground+" !important}",R=document.createElement("style");f||(R.styleSheet?R.styleSheet.cssText=d:R.appendChild(J().createTextNode(d))),J().getElementsByTagName("head")[0].appendChild(R);var p=function(b){var v=this;v.$22h=b,v.addListeners()};v.def(p,w,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var Q=this;Q.$36h&&V().removeChild(Q.$36h),Q.$23h=Q.$24h=Q.$25h=Q.$35h=Q.$36h=i},handle_touchstart:function(X){for(var P,i=this,q=i.$22h,O=X.target,a=q.sm(),V=q.dm(),R="palette-header",y="palette-header-tool",f="palette-item",I=!1,k=!1,S=!1;O&&(O[$]||"").indexOf(R)<0&&(O[$]||"").indexOf(f)<0;)O=O.parentNode;if(O&&O[$].indexOf(y)>=0?I=!0:O&&O[$].indexOf(R)>=0?S=!0:O&&O[$].indexOf(f)>=0&&(k=!0),v.isLeftButton(X))if(i.$27h(X))i.$24h=v.getClientPoint(X),i.$25h=q.ty();else if(I){v.preventDefault(X),P=O.parentNode.$11h;var j=V.getDataById(P),Q=j.s("tools")[O.toolIndex];Q.action&&Q.action.call(q)}else if(S){v.preventDefault(X),P=O.$11h;var j=V.getDataById(P);j.isExpanded()?j.setExpanded(!1):j.setExpanded(!0)}else if(k){P=O.$11h;var E=V.getDataById(P);a.ss(E),q.handleDragAndDrop&&(v.preventDefault(X),E.s("draggable")&&(q.handleDragAndDrop(X,"prepare"),i.$35h=0)),E.s("draggable")||(v.preventDefault(X),i.$24h=v.getClientPoint(X),i.$25h=q.ty())}else v.preventDefault(X),i.$24h=v.getClientPoint(X),i.$25h=q.ty();else i.$26h(X)},handle_mousedown:function(I){this.handle_touchstart(I)},handle_mousewheel:function(k){this.handleScroll(k,k.wheelDelta/40,k.wheelDelta!==k.wheelDeltaX)},handle_DOMMouseScroll:function(S){this.handleScroll(S,-S.detail,1)},handleScroll:function(A,F,q){var z=this.$22h;v.preventDefault(A),q&&z._41o()&&z.ty(z.ty()+20*F)},handle_mouseup:function(k){this.handle_touchend(k)},handle_touchend:function(S){var k=this;k.$37h(S),k.$26h(S)},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(l){var X=this;X.$37h(l),X.$26h(l)},$37h:function(g){var G=this,J=G.$22h;2===G.$35h&&(G.$35h=3,J.handleDragAndDrop(g,"end"))},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(e){var M=this,C=M.$22h,V=M.$23h,O=M.$24h,U=M.$25h,W=v.getClientPoint(e),H=C._29I,Q=M.$36h;if(1===M.$35h||2===M.$35h){if(M.$35h=2,C.handleDragAndDrop(e,"between"),f){var L=e.touches[0];e=L?L:e.changedTouches[0]}Q.style.left=e.pageX-parseInt(Q.width)/2+b,Q.style.top=e.pageY-parseInt(Q.height)/2+b}else"p"===V?C.ty(U+W.y-O.y):"v"===V&&C.ty(U+(O.y-W.y)/H.height*C._59I)},handle_mousemove:function(m){this.handle_touchmove(m)},handle_touchmove:function(c){if(!v.isDragging()&&v.isLeftButton(c)){var Y=this,p=Y.$22h,n=Y.$27h(c);if(Y.$24h){if(!Y.$23h){if(v.getDistance(v.getClientPoint(c),Y.$24h)<2)return;Y.$23h=n?"v":"p",v.startDragging(Y)}}else if(n)p._43o();else if(0===Y.$35h){if(Y.$35h=1,p.handleDragAndDrop(c,"begin"),f){var E=c.touches[0];c=E?E:c.changedTouches[0]}var _=Y.$36h=new Image,D=p.$10h[p.sm().ld().getId()].querySelector(".image-box"),O=parseInt(D.style.width),W=parseInt(D.style.height);_.draggable=!1,_.src=D.toDataURL(),_.width=O,_.height=W,_.style.position="absolute",_.style.left=c.pageX-O/2+b,_.style.top=c.pageY-W/2+b,V().appendChild(_),v.startDragging(Y)}}},$27h:function(m){var L=this.$22h,c=L.getView(),z=c.getBoundingClientRect(),r=L._29I,o=m.clientX-z.left+c.scrollLeft;return L._41o()&&r.x+r.width-o<e}}),ht.widget.Palette=function(H){var m=this,Z=m._view=k.createView(null,m);m.$9h={},m.$10h={},m.$4h={},m._29I={x:0,y:0,width:0,height:0},m._59I=0,m.dm(H?H:new ht.DataModel),Z[$]="ht-widget-palette",m.$29h=new p(m),y(Z,B,v.paletteContentBackground),y(Z,F,"auto"),y(Z,r,P),y(Z,"-moz-"+r,P),y(Z,"-webkit-"+z,O),y(Z,"-moz-"+z,O),y(Z,"-ms-"+z,O),y(Z,z,O),y(Z,"position","absolute"),y(Z,"overflow","hidden"),h(Z,m._79O=c()),E(Z,"dragstart",function(e){e.dataTransfer&&(e.dataTransfer.setData("Text","nodeid:"+e.target.$11h),e.dataTransfer.effectAllowed="all",m.$29h.$26h())})},l("Palette",w,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:v.autoHideScrollBar,_scrollBarSize:v.scrollBarSize,_scrollBarColor:v.scrollBarColor,getViewRect:function(){return this._29I},ty:function(m){return m?(this.setTranslateY(m),void 0):this.getTranslateY()},setTranslateY:function(X){if(this.$32h==i){var r=this,I=r.$33h(X),b=r.$30h;r.$30h=I,r.fp("translateY",b,I)}},getTranslateY:function(){return this.$30h},setLayout:function(r){var P,Y,Z=this,f=Z._layout;Z._layout=r,"smallicons"===r?P=Y=20:"iconsonly"===r?P=Y=50:(P=70,Y=50),Z.setItemImageWidth(P),Z.setItemImageHeight(Y),Z.setItemImagePadding(4),Z.fp("layout",f,r)},getDataAt:function(R){for(var o=R.target;o&&o.$11h==i;)o=o.parentNode;return o&&o.$11h!=i?this.getDataModel().getDataById(o.$11h):void 0},$20h:function(){var s=16;return f&&(s*=1.2),s},$19h:function(){return v.paletteTitleHeight},$18h:function(){var u=v.paletteSeparatorWidth,X=v.paletteTitleBackground,_=v.paletteSeparatorColor||v.brighter(X);return u+b+" solid "+_},$17h:function(c){y(c,"cursor","pointer"),y(c,"display","inline-block"),y(c,"margin-right",(f?8:4)+b),y(c,"vertical-align",W)},$1h:function(H){var R=this,c=s(),m=s(),U=x("span");c[$]="palette-header",y(c,T,"relative"),y(c,B,v.paletteTitleBackground),y(c,"color",v.paletteTitleLabelColor),y(c,W,A),y(c,r,P),y(c,"-moz-"+r,P),y(c,"padding","0 5px 0 0"),y(c,"border-top",R.$18h()),y(c,C,"100%"),y(c,"cursor","pointer"),y(c,"white-space","nowrap"),y(c,F,"hidden"),y(c,M,v.paletteTitleLabelFont),y(c,"line-height",R.$19h()+b),c.$11h=H.getId();var N=j(),X=R.$19h(),q=R.$20h();R.$17h(N),k.setCanvas(N,q,X),h(c,N);var G=H.s("tools");if(G)for(var L=0;L<G.length;L++){var g=j();R.$17h(g),k.setCanvas(g,q,X),g[$]="palette-header-tool palette-header-tool"+H.getId()+"-"+L,g.style.position="absolute",g.style.right=(q+10)*L+"px",g.toolIndex=L,h(c,g)}return N[$]="palette-toggle-icon-"+H.getId(),m[$]="palette-content",y(m,"max-height",0+b),y(m,M,v.paletteContentLabelFont),y(m,F,"hidden"),m.$11h=H.getId(),R.$9h[H.getId()]=m,U[Z]=H.getName(),y(U,M,v.paletteTitleLabelFont),h(c,N),h(c,U),[c,m]},$2h:function(g){var F=this,H=F._layout,z=Q&&g.s("draggable")?x("a"):s(),R=j(),n=s(),d=g.getName()||"",i=g.s("title")||g.getToolTip()||d,f=F._itemMargin;R[$]="image-box";var q=F.getItemImageWidth(),w=F.getItemImageHeight();return k.setCanvas(R,q,w),h(z,R),n[Z]=d,n[$]="label-box","iconsonly"!==H&&h(z,n),z[$]="palette-item",y(z,"vertical-align",W),y(z,"cursor","pointer"),y(z,"border-radius",5+b),y(z,"border","1px solid transparent"),y(z,"text-align","center"),y(z,"display","inline-block"),y(z,"margin-left",f+b),y(z,"margin-top",f+b),y(z,"color",v.paletteContentLabelColor),"smallicons"===H?(y(R,"vertical-align","middle"),y(z,"margin-left",2+b),y(z,"margin-top",2+b),y(z,"padding",2+b),y(z,"text-align",Y),y(n,"display","inline-block"),y(n,"min-width",F.$21h+F._itemMargin+b)):"largeicons"===H&&(y(n,"max-width",q+b),y(n,"overflow","hidden")),z.$11h=g.getId(),i&&(z.title=i),g.s("draggable")&&!F.handleDragAndDrop&&(Q?(z.href="#",y(z,"text-decoration",O)):z.draggable="true"),z},$16h:function(l,T,d,U){var I=k.initContext(l);k.translateAndScale(I,0,0,1),I.clearRect(0,0,d,d);var N=(d-U)/2;v.drawStretchImage(I,v.getImage(T),"fill",0,N,U,U),I.restore()},$15h:function(P){var W=this,X=P.getId(),o=W._view.querySelector(".palette-toggle-icon-"+X),N=P.isExpanded()?v.paletteCollapseIcon:v.paletteExpandIcon;if(o&&N){var f=W.$19h(),l=W.$20h();W.$16h(o,N,f,l)}},_drawToolsIcon:function(g){var x=this,L=g.s("tools");if(L)for(var A=0;A<L.length;A++){var $=x._view.querySelector(".palette-header-tool"+g.getId()+"-"+A),F=L[A].icon,B=x.$19h(),I=x.$20h();x.$16h($,F,B,I)}},$14h:function(_){var u=this,f=_.getId(),q=u.$10h[f].querySelector(".image-box"),G=_.getImage(),o=_.s("image.stretch");if(q&&G){var L=k.initContext(q),x=u.getItemImagePadding();x="smallicons"===u._layout?x/2:x;var M=u.getItemImageWidth()-2*x,n=u.getItemImageHeight()-2*x;k.translateAndScale(L,0,0,1),L.clearRect(0,0,M,n),v.drawStretchImage(L,v.getImage(G),o,x,x,M,n,_,u),L.restore()}},validateImpl:function(){var S,U,j,q=this,V=q.$9h,m=q._layout,C=q.$10h,o=q.$4h,P=q._view,$=q.dm();if(q.$13h&&(delete q.$13h,o={},$.each(function(O){o[O.getId()]=O})),"smallicons"===m)for(var T in o){var f=o[T];if(f instanceof g){var l=f.getName()||"",B=v.getTextSize(v.paletteContentLabelFont,l).width;q.$21h!=i&&q.$21h>B||(q.$21h=B)}}for(var T in o){j=o[T];var X,e;if($.contains(j)){if(j instanceof ht.Group){var s,p=q.$1h(j),w=C[j.getId()];w&&(s=w.nextSibling,L(P,s),L(P,w)),U=$.getSiblings(j).indexOf(j);var y=P.children[2*U]||q._79O;y&&y.parentNode?(P.insertBefore(p[0],y),P.insertBefore(s||p[1],y)):(P.appendChild(p[0]),P.appendChild(s||p[1])),C[j.getId()]=p[0],S=V[j.getId()]=s||p[1],e=j.$12h;var Y=j.s("promptText");e||(j.$12h=x("div"),j.$12h[Z]=Y||"",e=j.$12h),0===j.getChildren().size()?S.contains(e)||h(S,e):S.contains(e)&&L(S,e)}else if(X=j.getParent()){var J=q.$2h(j),H=C[j.getId()];S=V[X.getId()],H&&L(H.parentNode,H),U=$.getSiblings(j).indexOf(j);var E=S.children[U];E?S.insertBefore(J,E):h(S,J),C[j.getId()]=J,q.$14h(j)}}else{var k=C[j.getId()],r=k.parentNode;if(j instanceof ht.Group){var n=k.nextSibling;L(P,k),L(P,n),delete V[j.getId()]}else L(r,k),0===r.children.length&&(X=$.getDataById(r.$11h),e=X.$12h,e&&!r.contains(e)&&h(r,e));delete C[j.getId()]}}q.$4h={};var F=function(){var Q=q._59I,M=0;q.$32h!=i&&(clearInterval(q.$32h),M=0,delete q.$32h),q.$32h=setInterval(function(){q.$31h(),Q===q._59I?(M++,M>=2&&(clearInterval(q.$32h),delete q.$32h)):(M=0,Q=q._59I)},30)};for(var K in V)if(S=V[K],j=$.getDataById(V[K].$11h),q.$15h(j),q._drawToolsIcon(j),j.isExpanded()){if(S.style.maxHeight===0+b){var G=S.scrollHeight+q._itemMargin+b;u(S).duration(200).set(I,G).set("padding-bottom",q._itemMargin+b).end(function(){return function(){F()}}(G))}else S.style.maxHeight=S.scrollHeight+b;S.style.paddingBottom=q._itemMargin+b}else S.style.maxHeight!==0+b&&u(S).duration(200).set(I,A).set("padding-bottom",A).end(function(){return function(){F()}}(S));q.$28h(),q.$31h()},$31h:function(){for(var X=this,F=X._view,T=0,Z=F.children,Y=0;Y<Z.length;Y++){var u=Z[Y];u.className&&u.className.indexOf("palette-")>=0&&(T+=u.offsetHeight)}X._59I=T,X.$30h=X.$33h(X.ty());var H=X.ty();F.scrollTop=-H,X._29I={x:0,y:-H,width:F.clientWidth,height:F.clientHeight},y(X._79O,W,-H+b),X._93I()},$33h:function(W){var p=this,q=p._29I.height-p._59I;return q>W&&(W=q),W>0?0:Math.round(W)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(F){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(F.property)<0&&this.redraw(),"translateY"===F.property&&(this.iv(),this._43o())},findDataByName:function(q){for(var K=this.dm().getDatas(),l=0;l<K.size();l++){var t=K.get(l);if(t.getName()===q)return t}},setDataModel:function(T){var W=this,V=W._dataModel,Y=W._selectionModel;V!==T&&(V&&(V.umm(W.$6h,W),V.umd(W.$8h,W),V.umh(W.$7h,W),Y||V.sm().ums(W.$28h,W)),W._dataModel=T,T.mm(W.$6h,W),T.md(W.$8h,W),T.mh(W.$7h,W),Y?Y._21I(T):T.sm().ms(W.$28h,W),W.sm().setSelectionMode("single"),W.fp("dataModel",V,T))},$6h:function(f){var b=this,F=b._view,C=f.data,q=b.$4h;"add"===f.kind?q[C.getId()]=C:"remove"===f.kind?q[C.getId()]=C:"clear"===f.kind&&(b.$10h={},b.$9h={},b.$4h={},F[Z]=""),b.iv()},$7h:function(H){var Q=this,v=H.data;Q.$4h[v.getId()]=v,Q.iv()},$8h:function(E){var u=this,L=E.data,D=E.property;"expanded"===D?u.iv():(u.$4h[L.getId()]=L,u.iv())},$28h:function(){var p,h=this,I=h.sm(),x="palette-item",P=I.ld();this.dm().each(function(V){p=h.$10h[V.getId()],p&&p[$].indexOf(x)>=0&&(V===P?y(p,B,v.paletteItemSelectBackground):t(p,B))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);