!function(C,y){"use strict";var l="position",t="absolute",o="relative",$="px",i="left",G="right",w="top",c="bottom",h="display",_="none",I="block",g=ht.Default,R=g.getInternal(),U=Math.floor,J=Math.ceil,D=Math.PI,K=null,W=C.parseInt,f=function(f){return f.getContext("2d")},v=function(){return document},u=function(S){return v().createElement(S)},Q=function(){return u("canvas")},k=function(C,G,V){C.style.setProperty(G,V,K)},V=function(u,p,b){g.def(ht.widget[u],p,b)},A=function(r,B){r.appendChild(B)},a=function(r,P){r.removeChild(P)},r=function(p,S,G,u){p.addEventListener(S,G,!!u)},x=function(P,V,D,g){P.removeEventListener(V,D,!!g)};ht.widget.RulerFrame=function(M){var X=this,i=X._view=R.createView(null,X),g=X.$1k=Q(),O=X.$2k=Q(),U=X.$3k=Q(),H=X.$4k=Q();X._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},X._topRulerConfig={visible:!0},X._rightRulerConfig={visible:!1},X._bottomRulerConfig={visible:!1},X._leftRulerConfig={visible:!0},A(i,g),A(i,U),A(i,O),A(i,H),k(i,l,o),k(i,"box-sizing","border-box"),k(i,"-moz-box-sizing","border-box"),k(g,l,t),k(O,l,t),k(U,l,t),k(H,l,t),X.$14k=function(){X.$13k=1,X.iv()},X.$15k=function(_){if(X._topRulerConfig.guideVisible||X._rightRulerConfig.guideVisible||X._bottomRulerConfig.guideVisible||X._leftRulerConfig.guideVisible||X._defaultRulerConfig.guideVisible||(X._topRulerConfig.guideTipVisible||X._rightRulerConfig.guideTipVisible||X._bottomRulerConfig.guideTipVisible||X._leftRulerConfig.guideTipVisible||X._defaultRulerConfig.guideTipVisible)&&X._component){var v=i.getBoundingClientRect();X.$16k={x:_.clientX-v.left,y:_.clientY-v.top},X.$5k()}},X.setComponent(M)},V("RulerFrame",y,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(o){var e=this,J=e._component,X=e.getView();if(X){if(e._component=o,e.fp("component",J,o),J){var V=e.getComponentView(J);a(X,V),x(X,"mousemove",e.$15k),e.removeComponentPropertyChangeListener(J,e.$14k)}if(o){var W=e.getComponentView(o);A(X,W),k(W,l,t),r(X,"mousemove",e.$15k),e.addComponentPropertyChangeListener(o,e.$14k)}}},addComponentPropertyChangeListener:function(c,L){c&&c.mp&&c.mp(L)},removeComponentPropertyChangeListener:function(Q,p){Q&&Q.ump&&Q.ump(p)},getComponentHZoom:function(R){return R&&R.getZoom?R.getZoom():1},getComponentVZoom:function(q){return q&&q.getZoom?q.getZoom():1},getComponentViewRect:function(Z){return Z&&Z.getViewRect?Z.getViewRect():void 0},getComponentView:function(W){return W&&W.getView?W.getView():W},invalidateComponent:function(N){N&&N.iv&&N.iv()},validateComponent:function(f){f&&f.validate&&f.validate()},$7k:function(s,P,L,u,l,D,q,G,E,i,M,g){if(P.visible){var n=this._defaultRulerConfig,Y="borderStyle",c="borderColor",p="borderWidth",U="background",X=P[Y]||n[Y],a=P[c]||n[c],T=P[p]||n[p],z=P.size!=K?P.size:n.size,e=P[U]||n[U],t=z+T,H=this.$6k(T,X,a,s,L,l,t,q,G,E,i,M,g);k(s,l,"0px"),D?R.setCanvas(s,u-H,z):R.setCanvas(s,z,u-H),k(s,"background",e),k(s,h,I)}else k(s,h,_),k(this.getComponentView(this._component),l,"0px")},$6k:function(S,G,E,T,W,C,b,t,o,P,c,q,i){var H=0;return k(T,W,S+"px "+G+" "+E),k(this.getComponentView(this._component),C,b+$),t?(k(T,o,P+$),H+=P):k(T,o,"0px"),c?(k(T,q,i+$),H+=i):k(T,q,"0px"),H},validateImpl:function(){var k=this,L=k._component,x=k.$1k,H=k.$2k,v=k.$3k,t=k.$4k,B=k._view,V=k._defaultRulerConfig,$=k._topRulerConfig,J=k._rightRulerConfig,T=k._bottomRulerConfig,b=k._leftRulerConfig,U=V.size;if(B&&L){var Y=$.size!=K?$.size:U,Z=J.size!=K?J.size:U,n=T.size!=K?T.size:U,C=b.size!=K?b.size:U;k.$7k(x,$,"border-bottom",B.offsetWidth,w,!0,b.visible,i,C,J.visible,G,Z),k.$7k(H,J,"border-left",B.offsetHeight,G,!1,$.visible,w,Y,T.visible,c,n),k.$7k(v,T,"border-top",B.offsetWidth,c,!0,b.visible,i,C,J.visible,G,Z),k.$7k(t,b,"border-right",B.offsetHeight,i,!1,$.visible,w,Y,T.visible,c,n),k.$13k?delete k.$13k:k.invalidateComponent(L),k.validateComponent(L),k.$5k()}},$5k:function(){function a(z,P,k,y,X,R){if(P.visible){var w=f(z),r=P[N]||Q,_=P[c]!=K?P[c]:x,B=P[A]||W,I=P[S]||h,a=P.size!=K?P.size:C,wb=P[Y]||V,rq=P[m]||J,Jp=P[b]||F,ir=P[i]!=K?P[i]:o,Xj=P[t]!=K?P[t]:p,Ko=P[q]!=K?P[q]:T,Yc=P[L]!=K?P[L]:n,oi=P[M]!=K?P[M]:e,Sm=P[E]!=K?P[E]:D,Ce=P[d]||Dj,xj=P[u]||fe;_&&(r=O[R]=O.$8k(O[R]||r,P[v]||s,P[H]||Z,y?l:G,rq)),k.call(O,w,U,j,$,g,a,y?l:G,r,B,I,X,wb,Jp);var Ii=O.$16k;(ir||Xj)&&Ii&&(y?O.$9k(w,Ii.x,a,Ce,xj,ir,Xj,Ko,Yc,oi,Sm):O.$10k(w,Ii.y,a,Ce,xj,ir,Xj,Ko,Yc,oi,Sm,X))}}var O=this,P=O.$1k,w=O.$2k,R=O.$3k,X=O.$4k,z=O._topRulerConfig,r=O._rightRulerConfig,B=O._bottomRulerConfig,_=O._leftRulerConfig,k=O._defaultRulerConfig,I=O._component,y=O.getComponentViewRect(I),l=O.getComponentHZoom(I),G=O.getComponentVZoom(I),U=y.x*l,$=U+y.width*l,j=y.y*G,g=j+y.height*G,C=O._defaultRulerConfig.size,N="defaultMajorTickSpacing",v="maxPhysicalMajorTickSpacing",H="minPhysicalMajorTickSpacing",c="tickSpacingAdaptable",A="majorTickTextFont",S="majorTickTextColor",Y="majorTickColor",b="minorTickColor",i="guideVisible",t="guideTipVisible",q="guideTipBorderColor",L="guideTipTextColor",M="guideTipTextFont",E="guideTipBackground",d="guideColor",u="guideWidth",m="minMajorTickSpacing",Q=k[N],s=k[v],Z=k[H],x=k[c],W=k[A],h=k[S],V=k[Y],J=k[m],F=k[b],o=k[i],p=k[t],T=k[q],n=k[L],e=k[M],D=k[E],Dj=k[d],fe=k[u];O._view&&I&&(a(P,z,O.$11k,!0,!1,"_currentTopMajorTickSpacing"),a(w,r,O.$12k,!1,!0,"_currentRightMajorTickSpacing"),a(R,B,O.$11k,!0,!0,"_currentBottomMajorTickSpacing"),a(X,_,O.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(t,f,d,b,G){return d>t*b?t=U(f/b/G)*G:t*b>f&&(t=J(d/b/G)*G),t},getHTipText:function(q){var O=this,d=O._component,Z=0,t=O._view.getBoundingClientRect();return d.lp?Z=W(d.lp({clientX:q.x+t.left,clientY:q.y}).x):Z-=W(this.getComponentView(d).style.left)||0,Z},$9k:function(b,M,w,d,D,I,J,L,s,h,j){var t=this,K=t._component;b.save(),R.translateAndScale(b,0,0,1);var v=M-(W(this.getComponentView(K).style.left)||0),f=0;if(M=t.getHTipText(t.$16k),I&&(b.beginPath(),b.fillStyle=d,b.rect(v,f,D,w),b.fill()),J){b.beginPath(),b.textAlign="center",b.textBaseline="middle",b.font=h;var x=b.measureText(M).width+6;b.fillStyle=j,b.rect(v-x/2,f,x,w),b.fill(),b.strokeStyle=L,b.stroke(),b.beginPath(),b.fillStyle=s,b.fillText(M,v,f+w/2)}b.restore()},getVTipText:function(L){var U=this,y=U._component,x=0,P=U._view.getBoundingClientRect();return y.lp?x=W(y.lp({clientX:L.x,clientY:L.y+P.top}).y):x-=W(this.getComponentView(y).style.top)||0,x},formatScaleText:function(p){return Math.round(p)},$10k:function(t,o,I,w,p,k,d,T,B,F,_,Z){var L=this,A=L._component;t.save(),R.translateAndScale(t,0,0,1);var q=I/2,g=o-(W(this.getComponentView(A).style.top)||0);if(o=L.getVTipText(L.$16k),k&&(t.beginPath(),t.fillStyle=w,t.rect(q-I/2,g,I,p),t.fill()),d){t.translate(q,g),t.rotate((Z?90:-90)*D/180),t.translate(-q,-g),t.beginPath(),t.textAlign="center",t.textBaseline="middle",t.font=F;var e=t.measureText(o).width+6;t.fillStyle=_,t.rect(q-e/2,g-I/2,e,I),t.fill(),t.strokeStyle=T,t.stroke(),t.fillStyle=B,t.fillText(o,q,g)}t.restore()},$11k:function(o,L,j,s,w,V,Z,n,k,m,r,h,E){o.save(),j=0;var J=L,y=s,M=(J+y)/2;L=0,s=y-J,R.translateAndScale(o,0,0,1);var t=0,i=0,K=W(V/2),I=V-K,N=r?0:K,C=n*Z,F=C/10;L-=C,s+=C,o.clearRect(L,0,s-L,V),o.beginPath(),o.fillStyle=E;var g=U(M/F)*F-J;for(t=g;s>t;t+=F)o.rect(t,j+N,1,I);for(t=g;t>L;t-=F)o.rect(t,j+N,1,I);for(o.fill(),N=r?0:1,o.beginPath(),o.fillStyle=h,g=U(M/C)*C-J,t=g;s>t;t+=C)o.rect(t,j+N,1,V-1);for(t=g;t>L;t-=C)o.rect(t,j+N,1,V-1);o.fill();var z=W(/\d+px/.exec(k)[0]),H=(z||10)/2;o.textBaseline="middle",N=r?V-H-2:H+2,o.beginPath(),o.fillStyle=m,o.font=k;var P=U(M/C)*C/Z;for(t=g,i=P;s>t;t+=C,i+=n){var A=this.getHScaleText?this.getHScaleText(t):i;o.fillText(this.formatScaleText(A),t+2,j+N)}for(t=g,i=P;t>L;t-=C,i-=n){var A=this.getHScaleText?this.getHScaleText(t):i;o.fillText(this.formatScaleText(A),t+2,j+N)}o.restore()},$12k:function(b,E,h,X,F,n,g,J,T,s,e,Q,A){function K(d,s,v,M,Q,c){Q=r.getVScaleText?r.getVScaleText(v):Q,Q=r.formatScaleText(Q),b.translate(d+s,v),b.rotate(-M),b.translate(-d-s,-v),b.fillText(Q,d+s+(c?2:1),v),b.translate(d+s,v),b.rotate(M),b.translate(-d-s,-v)}b.save(),E=0;var Y=h,k=F,c=(Y+k)/2;h=0,F=k-Y,R.translateAndScale(b,0,0,1);var O=0,r=this,N=0,w=W(n/2),p=n-w,$=e?0:w,q=J*g,I=q/10;h-=q,F+=q,b.clearRect(E,0,n,F-h),b.beginPath(),b.fillStyle=A;var l=U(c/I)*I-Y;for(O=l;F>O;O+=I)b.rect(E+$,O,p,1);for(O=l;O>h;O-=I)b.rect(E+$,O,p,1);for(b.fill(),$=e?0:1,b.beginPath(),b.fillStyle=Q,l=U(c/q)*q-Y,O=l;F>O;O+=q)b.rect(E+$,O,n-1,1);for(O=l;O>h;O-=q)b.rect(E+$,O,n-1,1);b.fill();var t=W(/\d+px/.exec(T)[0]),d=(t||10)/2,V=90*D/180;b.textBaseline="middle",$=e?n-d:d+2,V=e?-V:V,b.beginPath(),b.fillStyle=s,b.font=T;var x=U(c/q)*q/g;for(O=l,N=x;F>O;O+=q,N+=J)K(E,$,O,V,N,e);for(O=l,N=x;O>h;O-=q,N-=J)K(E,$,O,V,N,e);b.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var i=this,c=i._component,B=i._view;c&&i.removeComponentPropertyChangeListener(c,i.$14k),B&&(x(B,"mousemove",i.$15k),a(B.parentNode,B),i._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);